
\section{泰勒公式与泰勒级数}
\label{sec:sec-taylor-formular}



\subsection{泰勒公式与麦克劳林公式}
\label{sec:taylor-formular}

在洛必达法则的例子中已经看到，反复应用洛必达法则可以得出一个函数的多项式逼近，这一节就来讨论这个问题。

假定函数$f(x)$在$x_0$处具有各阶导数（即直到接下来出现到的阶的导数），那么由连续性，$f(x)-f(x_0)$必然是一个无穷小($x \to x_0$)，为了寻求这个无穷小的阶，将其与$x-x_0$这个基本无穷小进行比较，即求极限
\[ \lim_{x \to x_0} \frac{f(x)-f(x_0)}{x-x_0} \]
由洛必达法则，假定函数的一阶导数连续(尤其是二阶可导)，上式的极限就是$f'(x_0)$，于是
\[ \frac{f(x)-f(x_0)}{x-x_0} = f'(x_0) + o(1) \]
或者改写为
\[ f(x) = f(x_0) + f'(x_0) (x-x_0) + o(x-x_0) \]
记
\[ T_1(x) = f(x_0)+f'(x_0)(x-x_0) \]
显然$T_1(x)$是一个一次多项式，并且与$f(x)$在$x_0$处具有相同的函数值以及一阶导数值，即
\[ f(x_0) = T_1(x_0), \  f'(x_0) = T_1'(x_0) \]

再考虑$f(x)-T_1(x)$，它是$x-x_0$的高阶无穷小，因此将它与$(x-x_0)^2$比较，即求极限
\[ \lim_{x \to x_0} \frac{f(x)-T_1(x)}{(x-x_0)^2} \]
假定$f(x)$二阶可导并且二阶导数连续，连续两次应用洛必达法则，得
\[ \lim_{x \to x_0} \frac{f(x)-T_1(x)}{(x-x_0)^2} = \lim_{x \to x_0} \frac{f'(x)-T_1'(x)}{2(x-x_0)} = \lim_{x \to x_0} \frac{f''(x)}{2} = \frac{1}{2} f''(x_0) \]
于是
\[ \frac{f(x)-T_1(x)}{(x-x_0)^2} = \frac{1}{2}f''(x_0) + o(1) \]
或者写成
\[ f(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2 + o((x-x_0)^2) \]
并记
\[ T_2(x) =  f(x_0) + f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2 \]
则$T_2(x)$与$f(x)$在$x_0$处具有相同的函数值以及一阶导数和二阶导数。

同样，假定函数存在连续的三阶导数，那么还有
\[ f(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\frac{f'''(x_0)}{3!}(x-x_0)^3 + o((x-x_0)^3) \]
如果还具有连续的四阶导数，则还有
\[ f(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\frac{f'''(x_0)}{3!}(x-x_0)^3+\frac{f^{(4)}(x_0)}{4!}(x-x_0)^4 + o((x-x_0)^4) \]
照此下去，如果函数$f(x)$在$x_0$的邻域上存在直到$n$阶的连续导函数，那么
\[ f(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+ \cdots +\frac{f^{(n)}(x_0)}{n!}x^n + o((x-x_0)^n) \]
记
\[ T_n(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+ \cdots +\frac{f^{(n)}(x_0)}{n!}x^n \]
这个多项式就称为函数$f(x)$在$x_0$处的泰勒多项式，它的主要特征是，它与$f(x)$在$x_0$处具有相同的函数值以及一阶导数、二阶导数直到$n$阶导数(函数值也可以被视为零阶导数)，即
\[ f(x_0)=T_n(x_0), \ f'(x_0) = T_n'(x_0), \  f''(x_0) = T_n''(x_0), \ \ldots, \  f^{(n)}(x_0) = T_n^{(n)}(x_0) \]
而函数的展开式则可以写成
\[ f(x) = T_n(x) + o((x-x_0)^n) \]
称为函数$f(x)$在$x_0$处的\emph{泰勒展开公式}.

于是我们得到如下的著名定理
\begin{theorem}[泰勒(Taylor)定理]
  如果函数$f(x)$在$x_0$的邻域内有直到$n$阶的导函数，作泰勒多项式
\[ T_n(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+ \cdots +\frac{f^{(n)}(x_0)}{n!}x^n \]
则有
\[ f(x_0)=T_n(x_0), \ f'(x_0) = T_n'(x_0), \  f''(x_0) = T_n''(x_0), \ \ldots, \  f^{(n)}(x_0) = T_n^{(n)}(x_0) \]
并且有下式成立
\[ f(x) = T_n(x) + o((x-x_0)^n) \]
这就是($n$阶)\emph{泰勒(Taylor)公式}，其中的余项$o((x-x_0)^n)$称为\emph{佩亚诺余项}.
\end{theorem}

我们用数学归纳法来证明.
\begin{proof}[证明]
  我们记
  \[ R(x) = f(x) - T_n(x) \]
  显然有
  \[ R(x_0) = R'(x_0) = \cdots = R^{(n)}(x_0) = 0 \]
  因此只要证明在这个条件下有
  \[ R(x) = o((x-x_0)^n) \]
  就可以了。
  
  当$n=1$时，由导数意义，有
  \[ \frac{R(x)-R(x_0)}{x-x_0} = R'(x_0) + o(1) \]
  注意到$R(x_0)=R'(x_0)=0$，所以
  \[ R(x) =  o(x-x_0) \]
  结论成立，假定定理对于$n$也是成立的，则看$n+1$的情形，此时设
  \[ S(x) = R'(x) \]
  就有
  \[ S(x_0) = S'(x_0) = \cdots = S^{(n)}(x_0) = 0 \]
  因此由归纳假设，有
  \[ S(x) = o((x-x_0)^n) \]
  再由洛必达法则，有
  \[ \lim_{x \to x_0} \frac{R(x)}{(x-x_0)^{n+1}} = \lim_{x \to x_0} \frac{S(x)}{(n+1)(x-x_0)^n} = 0 \]
  即
  \[ R(x) = o((x-x_0)^{n+1}) \]
  由归纳法，定理成立。
\end{proof}

注意到，在前面的推导过程中，我们要求函数具有直到$n$阶的连续导函数，但在这个定理的证明过程中，第$n$阶导函数是否连续并没有用到，这是为什么呢，用前面推导到二阶展开式那里的情况说明，那时有
\[ \lim_{x \to x_0} \frac{f(x)-T_1(x)}{(x-x_0)^2} = \lim_{x \to x_0} \frac{f'(x)-T_1'(x)}{2(x-x_0)} = \lim_{x \to x_0} \frac{f''(x)}{2} = \frac{1}{2} f''(x_0) \]
最后一步，求极限$\lim_{x \to x_0} f''(x_0)$，那里我们是假定二阶导函数连续，得出这个极限为$f''(x_0)$的，但实际上由导函数连续性定理可知，如果这个极限存在，设为$K$，那么函数在$x_0$处必然存在二阶导数，且$f''(x_0)=K$，所以我们不要求二阶导数在$x_0$处连续，仅要求$f''(x_0)$存在就行，只要存在就必然连续，所以定理中的条件就减弱为在$x_0$的邻域上存在直到$n$阶的导函数。

在泰勒公式中，取$x_0 = 0$，我们就得到如下的\emph{麦克劳克(Maclaurin)公式}:
\[ f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + o(x^n) \]

\begin{example}
  既然公式是函数的多项式展开，那么多项式函数自己的展开式会是什么样呢？ 设多项式函数
  \[ f(x) = a_nx^n+a_{n-1}x^{n-1}+\cdots+a_1x+a_0 \]
  先写出它的$n$阶泰勒多项式
\[ T_n(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+ \cdots +\frac{f^{(n)}(x_0)}{n!}x^n \]
可以发现，它也是一个$n$次多项式，按泰勒定理，这两个多项式相差一个$(x-x_0)^n$的高阶无穷小，我们指出，对于$n$次多项式函数$f(x)$而言，它与它的$n$阶泰勒展开式的差值是零，也就是
\[ f(x) = T_n(x) \]
我们利用归纳法证明下面的结论，有了下面这个结论，这里的结论也就成立了。

\begin{statement}
  如果两个次数不超过$n$次的多项式$f(x)$与$g(x)$在$x_0$处直到$n$阶的导数值都相同，即
  \[ f'(x_0) = g'(x_0), \  f''(x_0) = g''(x_0), \  \ldots, \  f^{(n)}(x_0) = g^{(n)}(x_0) \]
  则这两个多项式仅相差一个常数，即$f(x)-g(x)=C$，这里$C$是一个固定的常数.
\end{statement}

显然结论对于常数多项式和一次多项式均成立，假设结论对于$\leqslant n$的情况都成立，现在假定$f(x)$和$g(x)$都是$n+1$次多项式，并且在$x_0$处两者具有相同的直到$n+1$阶的导数，那么它们的导数$f'(x)$和$g'(x)$在$x_0$处就具有相同的直到$n$阶导数，根据归纳假设，存在常数$C_1$，使得$f'(x)-g'(x)=C_1$，但由于$f'(x_0)=g'(x_0)$，所以$C_1=0$，即$f'(x)=g'(x)$，于是对于多项式$h(x)=f(x)-g(x)$有$h'(x)=0$，于是$h(x)$只能是常数多项式，即$h(x)=f(x)-g(x)=C$.
\end{example}

如果把函数值视为零阶导数，那么这个命题可以改叙为以下更为美观的形式
\begin{statement}
  如果两个次数不超过$n$次的多项式$f(x)$与$g(x)$在$x_0$处从零阶直到$n$阶的导数值都相同，即
  \[ f(x_0)=g(x_0), \  f'(x_0) = g'(x_0), \  f''(x_0) = g''(x_0), \  \ldots, \  f^{(n)}(x_0) = g^{(n)}(x_0) \]
  则这两个多项式相等.
\end{statement}

有了这结论之后，由于$n$次多项式$f(x)$与它的$n$阶泰勒多项式在$x_0$具有相同的直到$n$阶的导数，因此它俩仅相差一个常数，但又由于$f(x_0)=T_n(x_0)$，所以有$f(x)=T_n(x)$.

\subsection{泰勒级数}
\label{sec:taylor-series}

泰勒公式成立的条件是函数$f(x)$在$x_0$的邻域内有直到$n$阶的导函数，公式可以展到 $(x-x_0)^n$，如果函数在这邻域内存在任意阶的导函数，那么这个公式就可以无限写下去，成为一个无穷级数，即
\[ f(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+\cdots \]
或者按照级数的写法
\[ f(x) = f(x_0) + \sum_{n=1}^{\infty} \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n \]
如果把函数值$f(x_0)$视为函数在$x_0$处的零阶导数，那么第一项也可以归级数中去:
\[ f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n \]
这个级数就称为\emph{泰勒级数}，但我们还需说明它在$x$处的收敛性.

记右侧级数的部分和为$T_n(x)$，它就是函数$f(x)$在$x_0$处展到$n$阶导数的泰勒多项式，泰勒公式刻画了 $f(x)-T_n(x)$ 在$x\to x_0$时会成为$(x-x_0)^n$的高阶无穷小，但泰勒级数要收敛，需要说明$f(x)-T_n(x)$在$n\to\infty$时也能成为无穷小.

\subsection{基本函数的泰勒展式}
\label{sec:taylor-expand-for-fundation-function}

在这一小节，我们来求一些基本函数在$x=0$处的泰勒展开式，即麦克劳林展开式。

1. 幂函数$f(x)=x^p(x>0)$.

由于它已经是在$x=0$处的展开式了，所以我们考虑它在$x=1$处的泰勒展开，在作代换$t=x-1$之后，实际就是要求函数$f(t)=(1+t)^p$在$t=0$处的展开式，我们还是用$x$来替换$t$，那么根据前面已经求得的高阶导数值，有
\[ (1+x)^p = 1 + px + \frac{p(p-1)}{2!}x^2 + \cdots + \frac{p(p-1)\cdots (p-n+1)}{n!}x^n + o(x^n) \]
显然，如果$p$是正整数，由于$n$次多项式的$n$阶导数成为常数，更高阶的导数则恒零，因此这个展开式就成为二项式定理了
\[ (1+x)^n = 1+nx + \frac{n(n-1)}{2!}x^2 + \frac{n(n-1)(n-2)}{3!}x^3 + \cdots + x^n \]
因此这式子可以看作是二项式定理的推广，它被称为\emph{牛顿二项式定理}.

在式中令$p=-1$，并将$x$替换为$-x$，得
\[ \frac{1}{1-x} = 1+x+x^2 + \cdots + x^n + o(x^n) \]
同样，取$p=\frac{1}{2}$，得
\[ \sqrt{1+x} = 1+\frac{1}{2}x-\frac{1}{8}x^2+\frac{3}{48}x^3 + o(x^3) \]
取$p=-\frac{1}{2}$，得
\[ \frac{1}{\sqrt{1+x}} = 1-\frac{1}{2}x+\frac{3}{8}x^2 -\frac{15}{48}x^3 + o(x^3) \]

1. 指数函数$f(x)=\mathrm{e}^x$.

根据在高阶导数那一小节我们求得的指数函数的高阶导数公式，我们得出
\[ \mathrm{e}^x = 1+x+\frac{1}{2!}x^2 + \cdots + \frac{1}{n!}x^n + o(x^n) \]

2. 对数函数$f(x)=\ln{x}$.

由于对数函数在$x=0$处无定义，所以我们考虑它在$x=1$处的展开式，实际上就是求$\ln{(1+x)}$在$x=0$处的展开式，这时有
\[ \ln{(1+x)} = x - \frac{1}{2} x^2 + \frac{1}{3} x^3 - \cdots + \frac{(-1)^{n-1}}{n}x^n + o(x^n) \]

3. 三角函数

对正弦函数，有
\[ \sin{x} = x - \frac{1}{3!}x^3 + \frac{1}{5!} x^5 - \cdots + \frac{(-1)^n}{(2n+1)!}x^{2n+1} + o(x^{2n+1}) \]
对于余弦函数，则是
\[ \cos{x} = 1 - \frac{1}{2!}x^2 + \frac{1}{4!}x^4 - \cdots + \frac{(-1)^n}{(2n)!}x^{2n} + o(x^{2n}) \]

\subsection{余项的其它形式}
\label{sec:other-format-of-taylor-additional}

\subsection{幂级数}
\label{sec:power-series}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../calculus-note"
%%% End: