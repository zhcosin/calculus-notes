
\section{导数与微分}
\label{sec:derivative-and-differtial}

\subsection{概念与几何意义}
\label{sec:concept-of-derivative}

我们先来看产生导数概念的物理学和几何学背景。

在运动物理学中，假如一个质点的位移随时间变化的方程是$s=s(t)$，现在考虑质点在$t=t_0$时刻的瞬间速度，我们用它在$t_0$附近很小的一段时间内的平均速度来逼近它，给时间一个增量$\Delta t$，则在时间段$[t_0,t_0+\Delta t]$内的平均速度是
\[ \frac{s(t_0+\Delta t)-s(t_0)}{\Delta t} \]
如果令$\Delta t$ 无限缩小，即让$\Delta t \to 0$，那么这个平均速度将无限逼近质点在$t=t_0$处的瞬时速度。

为了找到一条曲线在其上某点处的切线，假如恰当的选择坐标系后，曲线可以用一个连续函数$y=f(x)$来表示，点$P(x_0,f(x_0))$是这函数图象上一点，为了寻找函数图象在该点处的切线，可以从这图象上靠近点$P$的另一点$Q(x,f(x))$，并出割线$PQ$，其斜率是
\[ \frac{f(x)-f(x_0)}{x-x_0} \]
在$x \to x_0$时，割线将无限的与函数图象在$x_0$处的切线靠近，其极限位置就是该点处的切线，因此，上式的极限便是函数在$x_0$处的切线的斜率，设其为$K$，则曲线在$x_0$处的切线方程就是
\[ y-y_0 = K(x-x_0) \]

这两个例子都提出了一个问题，即对于给定函数$f(x)$，要求它在某点$x=x_0$处的下面这个表达式的极限值:
\[ \frac{f(x)-f(x_0)}{x-x_0} \]
或者写成另一种形式
\[ \frac{f(x_0+\Delta x)-f(x_0)}{\Delta x} \]
这个比值实际上就是函数值对自变量的变化率，这就引入了导数的概念。

\begin{definition}
  设函数$f(x)$在$x_0$的某邻域内有定义，如果极限
  \[ \lim_{x \to x_0} \frac{f(x)-f(x_0)}{x-x_0} \]
  存在，则称函数$f(x)$在$x_0$处\emph{可导}，也称为\emph{可微}，此极限值称为$f(x)$在$x_0$处的\emph{导数}，并记为$f'(x_0)$，或者称为\emph{微商} \footnote{这个称呼及记号的意义在介绍了微分的概念后就清楚了。}，记为$\frac{\dif y}{\dif x} \big| _{x=x_0} $,即
  \[ f'(x_0) = \frac{\dif y}{\dif x} \big| _{x=x_0} = \lim_{x \to x_0} \frac{f(x)-f(x_0)}{x-x_0} \]
  如果前述极限不存在，则称函数在该点处不可导. 类似的，把极限过程分别替换为左极限和右极限，就得出\emph{左导数}$f_-'(x_0)$和\emph{右导数}$f_+'(x_0)$的概念，即
  \[ f_-'(x_0) = \lim_{x \to x_0^-} \frac{f(x)-f(x_0)}{x-x_0}, \ f_+'(x_0) = \lim_{x \to x_0} \frac{f(x)-f(x_0)}{x-x_0} \]
\end{definition}

显然，函数在某点处可导的充分必要条件是，该点既左可导又右可导，且左右导数相等。

容易看出，如果在某点可导，则必在该点处连续。

如果函数$f(x)$在$x_0$处可导，则在此处有
\[ \frac{\Delta y}{\Delta x} = f'(x_0)+\alpha \]
其中$\alpha$是一个无穷小，于是有
\[ \Delta y = f'(x_0)\Delta x + o(\Delta x) \]
即由一个$\Delta x$的一个线性式子加上一个$\Delta x$的高阶无穷小.这公式可以用于对函数进行估值，只要给定了$x_0$处的函数值以及该点处的导数，就可以近似的估计该点附近的函数值。

下面引入导函数的概念，考虑前面的瞬时速度的例子，给定位移随时间变动的函数$s=s(t)$，我们已经知道它在指定时刻$t=t_0$的瞬时速度就是位移函数在$t=t_0$处的导数值，显然，瞬时速度也是随着时间变化的物理量，即速度函数$v=v(t)$，它的特点是，它在任意时刻$t=t_0$的函数值，正好是位移函数$s=s(t)$在该处的导数值，即它是位移函数的导数函数，由此给出\emph{导函数}的定义:
\begin{definition}
  如果函数$f(x)$在某个区间上有定义，并且在该区间上处处可导（闭区间上的端点处只要单侧可导），则称函数在该区间上可导，而由自变量映射导数值构成一个新的函数$f'(x)$，称为函数$f(x)$的\emph{导函数}，与之相应的，函数 $f(x)$ 则称为函数 $f'(x)$ 的(一个)\emph{原函数}.
\end{definition}

\begin{example}
  常数函数$f(x)=C$，由于函数的增量始终为零，所以它在任意点处都可导，且导数为零。
\end{example}

\begin{example}
  设$n \in \mathbb{Z}$，我们来求幂函数$f(x)=x^n(n \in N_+)$在$x_0$处的导数，因为
  \[ \frac{x^n-x_0^n}{x-x_0} = x^{n-1}+x^{n-2}x_0+\cdots+xx_0^{n-2}+x_0^{n-1} \]
  上式右端在$x \to x_0$时显然以$nx_0^{n-1}$为极限，于是该函数的导函数是
  \[ (x^n)' = nx^{n-1} \]
\end{example}

\begin{example}
  函数$f(x)=\frac{1}{x}$在$x_0 \neq 0$处的导数，有
  \[ \frac{\frac{1}{x}-\frac{1}{x_0}}{x-x_0} = - \frac{1}{xx_0} \]
  令$x \to x_0$，便知函数在$x_0$处的导数值是$-\frac{1}{x_0^2}$，于是有
  \[ \left( \frac{1}{x} \right)' = - \frac{1}{x^2} \]
\end{example}

\begin{example}
  函数$f(x)=\sqrt{x}$在$x_0$处，有
  \[ \frac{\sqrt{x}-\sqrt{x_0}}{x-x_0} = \frac{1}{\sqrt{x}+\sqrt{x_0}} \]
  因此，函数在$x_0$处的导数值是$\frac{1}{2 \sqrt{x_0}}$，即它的导函数是
  \[ \left( \sqrt{x} \right) ' = \frac{1}{2 \sqrt{x}} \]
\end{example}

\begin{example}
 我们在 \autoref{example:limit-of-sinx-sinx0-over-x-x0} 中已经证明了下面两个极限:
  \[ \lim_{x \to x_0} \frac{\sin{x}-\sin{x_0}}{x-x_0} = \cos{x_0}, \  
   \lim_{x \to x_0} \frac{\cos{x}-\cos{x_0}}{x-x_0} = -\sin{x_0} \]
 于是有
 \[ (\sin{x})' = \cos{x}, \  (\cos{x})' = - \sin{x} \]
\end{example}

\begin{example}
  现在来求指数函数$f(x)=a^x(a>0,a\neq 1)$在任意点$x_0$处的导数。
  利用在 \autoref{example:e-power-x-1-equalitant-to-x} 中求得的极限，有
  \[ \lim_{x \to x_0} \frac{a^{x}-a^{x_0}}{x-x_0} = \lim_{x \to x_0} a^{x_0} \frac{a^{x-x_0}-1}{x-x_0} = \lim_{h \to 0} a^{x_0} \frac{a^h-1}{h} = a^{x_0} \ln{a} \]
  于是有
  \[ (a^x)' = a^x \ln{a} \]
  特别的有 $(e^x)'=e^x$，这就是说，以$\mathrm{e}$为底的指数函数的导函数就是它自己，这非常重要且有趣.
\end{example}

\begin{example}
  我们在\autoref{example:function-with-continuous-at-single-point}中利用狄利克雷函数构造了仅在一个点处连续的函数例子:$f(x)=xD(x)$，我们指出，这个函数虽然在$x=0$处连续，但在此处却不可导，因为当$x$分别取有理数值和无理数值并趋于零时，变化率
  \[ \frac{f(x)-f(0)}{x-0} = \frac{f(x)}{x} = D(x) \]
  分别趋于两个不同的极限值，所以不可导，但是如果我们把函数中的无穷小因子升次，变成
  \[ f(x)=x^2D(x) \]
  此时有
  \[ \lim_{x \to 0} \frac{f(x)-f(0)}{x-0} = \lim_{x \to 0} xD(x) = 0 \]
  这表明这个新构造的函数在$x=0$处可导，且导数为零，然而它在除$x=0$之外的其它点处均不连续，所以也就不可导，于是它成为了仅在一个点处连续且可导的函数例子。
\end{example}

\subsection{求导法则}
\label{sec:rule-of-derivative}

\begin{theorem}
  设函数$f(x)$和$g(x)$在$x_0$的某个邻域内有定义且在$x_0$处可导，则函数$u(x)=f(x)+g(x)$和$v(x)=f(x)-g(x)$在$x_0$处也可导，并且
  \[ u'(x_0)=f'(x_0)+g'(x_0), \  v'(x)=f'(x_0)-g'(x_0) \]
\end{theorem}

只要注意到$\Delta u=\Delta f+\Delta g$以及$\Delta v=\Delta f+ \Delta g$即可得知结论成立。

\begin{theorem}
  设函数$f(x)$和$g(x)$在$x_0$的某个邻域内有定义并且在$x_0$处可导，则函数$u(x)=f(x)g(x)$在$x_0$处也可导，并且
  \[ u'(x_0)=f'(x_0)g(x_0)+f(x_0)g'(x_0) \]
\end{theorem}

\begin{proof}[证明]
  因为
  \begin{eqnarray*}
    u(x)-u(x_0) & = & f(x)g(x)-f(x_0)g(x_0) \\
                & = & [f(x)-f(x_0)]g(x)+f(x_0)[g(x)-g(x_0)]
  \end{eqnarray*}
  于是
  \[ \frac{u(x)-u(x_0)}{x-x_0} = \frac{f(x)-f(x_0)}{x-x_0}g(x)+f(x_0)\frac{g(x)-g(x_0)}{x-x_0} \]
  两边令$x \to x_0$便得结论.
\end{proof}

利用数学归纳法，可以把这结论推广到多个函数相乘的情况:
\begin{theorem}
  设有若干个函数$f_i(x)(i=1,2,\ldots,n)$都在$x_0$的某个邻域内有定义，又若它们都在$x_0$处可导，则函数$P(x)=\prod\limits_{i=1}^nf_i(x)$在$x_0$处也可导，并且
  \[ P'(x_0) = \prod_{i=1}^nf_i(x_0) \cdot \sum_{i=1}^n \frac{f_i'(x_0)}{f_i(x_0)} \]
\end{theorem}

\begin{theorem}
  设函数$f(x)$在$x_0$的某邻域内有定义且$f(x) \neq 0$，并且在$x_0$处可导，则函数$u(x)=\frac{1}{f(x)}$在$x_0$处也可导，且有
  \[ u'(x) = -\frac{f'(x_0)}{f^2(x_0)} \]
\end{theorem}

\begin{proof}[证明]
  因为
  \begin{eqnarray*}
    \frac{u(x)-u(x_0)}{x-x_0} & = & \frac{\frac{1}{f(x)}-\frac{1}{f(x_0)}}{x-x_0} \\
    & = & - \frac{1}{f(x)f(x_0)} \cdot \frac{f(x)-f(x_0)}{x-x_0}
  \end{eqnarray*}
  令$x \to x_0$取极限即得结论.
\end{proof}

由这个定理可得下面推论，当然这推论直接使用导数定义也是可以验证的。
\begin{inference}
  函数$y=Cf(x)$的导函数是$y'=Cf'(x)$，如果$f(x)$存在导函数，这里$C$是任意实常数。
\end{inference}

由以上两个定理，只要把两个函数的商函数$\frac{f(x)}{g(x)}$写成$f(x)\cdot \frac{1}{g(x)}$，就得到
\begin{theorem}
  设函数$f(x)$和$g(x)$都在$x_0$的某个邻域内有定义且$g(x)\neq 0$，如果两者都在$x_0$处可导，则$u(x)=\frac{f(x)}{g(x)}$在$x_0$处可导，并且有
  \[ u'(x_0) = \frac{f'(x_0)g(x_0)-f(x_0)g'(x_0)}{g^2(x_0)} \]
\end{theorem}

\begin{example}
  考察多项式函数
  \[ f(x) = a_nx^n+a_{n-1}x^{n-1}+\cdots+a_1x+a_0 \]
  现在容易得知它的导函数是
  \[ f'(x) = na_nx^{n-1}+(n-1)a_{n-1}x^{n-2}+\cdots+2a_2x+a_1 \]
  显然，$n$次多项式函数的导函数是$n-1$次多项式函数。
\end{example}

\begin{example}
  由商的求导法则，可得出正切函数的导函数
  \begin{eqnarray*}
    \tan'{x} & = & \left( \frac{\sin{x}}{\cos{x}} \right)'  \\
             & = & \frac{(\sin{x})'\cos{x}-\sin{x}(\cos{x})'}{\cos^2{x}} \\
             & = & \frac{\cos^2{x}+\sin^2{x}}{\cos^2{x}} \\
    & = & \frac{1}{\cos^2{x}} = \sec^2{x}
  \end{eqnarray*}

  以及
  \[ (\sec{x})' = \frac{\sin{x}}{\cos^2{x}}, \  (\csc{x})'=-\frac{\cos{x}}{\sin^2{x}} \]
\end{example}


\subsection{反函数的导数}
\label{sec:derivative-of-revert-function}

\begin{theorem}
  如果函数$f(x)$在$x_0$的某个邻域上严格单调，且在$x_0$处存在非零的导数，则其反函数$x=\varphi(y)$在$y_0=f(x_0)$处亦可导，且导数值
  \[ \varphi '(y_0) = \frac{1}{f'(x_0)} \]
\end{theorem}

\begin{proof}[证明]
  由于严格单调且连续，所以$x \to x_0$等价于$y \to y_0$，因此有
  \[ \lim_{y \to y_0} \frac{\varphi(y)-\varphi(y_0)}{y-y_0} = \lim_{x \to x_0} \frac{x-x_0}{f(x)-f(x_0)} = \frac{1}{f'(x_0)} \]
\end{proof}

\begin{example}
  由指数函数的导数，可以得到对数函数的导数，函数$y=a^x(a>0, a \neq 1)$的导函数是$y'=a^x \ln{a}$，于是它的反函数$x=\log_a y$的导函数就是$x'=\frac{1}{a^x \ln{a}}=\frac{\log_a \mathrm{e}}{y}$，特别的是 $(\ln{x})'=\frac{1}{x}$.
\end{example}

\begin{example}
  来求一下反三角函数的导数，因为$(\sin{x})'=\cos{x}$，所以
  \[ (\arcsin{y})'=\frac{1}{(\sin{x})'} = \frac{1}{\cos{x}} = \frac{1}{\sqrt{1-y^2}} \]
  注意反正弦的取值范围是$(-\frac{\pi}{2},\frac{\pi}{2})$，所以这里余弦是正值，这就是反正弦函数的导数，同样可求得反余弦导函数
  \[ (\arccos{y})' = - \frac{1}{\sqrt{1-y^2}} \]
  对于反正切函数，则有
  \[ (\arctan{y})' = \frac{1}{(\tan{x})'} = \cos^2{x} = \frac{1}{1+\tan^2{x}} = \frac{1}{1+y^2} \]
\end{example}

\subsection{复合函数的导数}
\label{sec:derivative-of-embed-function}

\begin{theorem}
  设函数$u=\varphi(x)$在$x_0$处可导，而函数$y=f(u)$在$u_0=\varphi(x)$处亦可导，且$y=f(u)$在$u_0$的某空心邻域内函数值恒不与$f(u_0)$相同，则复合函数$y=f(\varphi(x))$在$x_0$处可导，且导数值为$f'(u_0)\varphi '(x_0)$.
\end{theorem}

\begin{proof}[证明]
  由$x=\varphi(x)$在$x_0$处的连续性，当$x \to x_0$时亦必有$u \to u_0$，于是在等式
  \[ \frac{f(\varphi(x))-f(\varphi(x_0))}{x-x_0} = \frac{f(\varphi(x))-f(\varphi(x_0))}{\varphi(x)-\varphi(x_0)} \cdot \frac{\varphi(x)-\varphi(x_0)}{x-x_0} = \frac{f(u)-f(u_0)}{u-u_0} \cdot \frac{\varphi(x)-\varphi(x_0)}{x-x_0} \]
  两边令$x \to x_0$便得结论.
\end{proof}

根据定理，函数$y=f(\varphi(x))$的导函数是$y'=f'(\varphi(x))\varphi '(x)$.

\begin{example}
  对于双曲函数的导函数，将双曲余弦$y=\cos{x}=\frac{e^x+e^{-x}}{2}$看成$\varphi(x)=e^x$以及$f(x)=\frac{u+\frac{1}{u}}{2}$的复合，就有
  \[ (\cosh{x})' = \left( \frac{\mathrm{e}^x+\mathrm{e}^{-x}}{2} \right)' = \frac{\mathrm{e}^x-\mathrm{e}^{-x}}{2} = \sinh{x} \]
  同样有
  \[ (\sinh{x})' = \cosh{x} \]
  这跟三角函数的求导函数非常类似，以后我们还会看到，双曲函数在很多方面都跟三角函数有类似的性质。
\end{example}

\begin{example}
  我们也可以把余弦函数$y=\cos{x}$写成$y=\sin{\left( x+\frac{\pi}{2} \right)}$，从而将它看成是由$y=\sin{u}$以及$u=x+\frac{\pi}{2}$复合而成，于是便得
  \[ (\cos{x})' = (\sin{u})' \cdot u'(x) = \cos{u} = \cos{\left( x+\frac{\pi}{2} \right)} = - \sin{x} \]
\end{example}

\begin{example}
  我们已经知道幂函数$x^n(x>0, n \in \mathbb{N}_+)$的导函数是$nx^{n-1}$，现在我们将这一结果推广为，任意幂函数$x^p(x>0, p \in \mathbb{R})$的导函数都是$px^{p-1}$.

  显然$p=0$时结论成立，如果$p$为有理数$\frac{m}{n}$，那么对于下式
  \[ \frac{(x+\Delta x)^{m/n}-x^{m/n}}{\Delta x} \]
  令$a=(x+\Delta x)^{m/n}$及$b=x^{m/n}$并借用公式
  \[ a-b = \frac{a^n-b^n}{a^{n-1}+a^{n-2}b+\cdots+ab^{n-2}+b^{n-1}} \]
  可得
  \[ \frac{(x+\Delta x)^{m/n}-x^{m/n}}{\Delta x} = \frac{(x+\Delta x)^m - x^m}{\Delta x (a^{n-1}+a^{n-2}b+\cdots+ab^{n-2}+b^{n-1})} \]
  令$\Delta x \to 0$，显然有
  \[ \frac{(x+\Delta x)^m - x^m}{\Delta x} \to m x^{m-1} \]
  而因子$a^{n-1}+a^{n-2}b+\cdots+ab^{n-2}+b^{n-1}$中的每一项都趋于$x^{m(n-1)/n}$，因此整个式子的极限便是
  \[ \frac{mx^{m-1}}{nx^{m(n-1)/n}} = \frac{m}{n} x^{\frac{m}{n}-1} \]
  于是结论对于$p \in \mathbb{Q}$都成立。

  但当考虑到$p$为无理数的情形时，上面的方法就失效了，我们不得不寻求别的方法，在这里，我们把$x^p$写成复合函数的形式$y=\mathrm{e}^{p \ln{x}}$，于是可以求得
  \[ (x^p)' = (\mathrm{e}^{p \ln{x}})' = \mathrm{e}^{p \ln{x}} \cdot (p \ln{x})' = \mathrm{e}^{p \ln{x}} \cdot \frac{p}{x} = px^{p-1} \]
  于是就证明了结论。
\end{example}

\begin{example}
  仿上例的方法，设函数$u(x)$和$v(x)$均可导，我们来求$y=u(x)^{v(x)}$的导函数，同样把它写成$y=\mathrm{e}^{v(x) \ln{u(x)}}$的形式，可求得
  \[ y'=e^{v(x) \ln{u(x)}} (v(x) \ln{u(x)})' = u(x)^{v(x)} (v'(x)\ln{u(x)}+\frac{v(x)u'(x)}{u(x)}) \]
\end{example}

\begin{example}
  假如函数$f(x)$的定义域关于$x=0$对称，如果它是奇函数，即对任意$x$成立$f(-x)=-f(x)$，那么可以证明，它的导函数$f'(x)$一定是偶函数，反之，如果$f(x)$是偶函数，那么它的导函数$f'(x)$一定是奇函数，这在正弦函数和余弦函数的身上已经得到验证。
\end{example}

\subsection{求导公式表}
\label{sec:table-of-derivative-formule}

我们把到现在为止，我们已经求得的导数公式列在这里:

1. 常函数 $(C)' = 0$

2. 幂函数 $(x^p)' = p x^{p-1}, (p \in \mathbb{R},x>0)$.

3. 指数函数 $(a^x)' = a^x \ln{a}$，对数函数$(\log_a x)' = \frac{\log_a \mathrm{e}}{x}$，特殊情况是 $(\mathrm{e}^x)' = \mathrm{e}^x$与$(\ln{x})'=\frac{1}{x}$.

4. 三角函数与反三角函数 $(\sin{x})' = \cos{x}$，$(\cos{x})'=-\sin{x}$，$(\tan{x})'=\sec^2{x}$，$(\arcsin{x})' = \frac{1}{\sqrt{1-x^2}}$，$(\arccos{x})'= - \frac{1}{\sqrt{1-x^2}}$，$(\arctan{x})' = \frac{1}{1+x^2}$.

\subsection{参变量函数的导数}
\label{sec:derivative-of-parametered-function}

前面已经提过，引入导数概念的一个几何背景就是求曲线上某点处的切线，这个问题在曲线方程是用函数方程$y=f(x)$来表达的情形下已经解决了，但是通常一般的曲线并不能表达为一个函数，而是由参数方程表达的，比如圆的参数方程是$x=\cos{\theta},y=\sin{\theta}$，假定一段曲线的参数方程是
\[
  \begin{cases}
    x = x(t) \\
    y = y(t)
  \end{cases}
\]
假定参数$t$在$t_0$的某个邻域内变化，且两个分函数都在这个邻域上可导，那么有
\[ \frac{\Delta y}{\Delta x} = \frac{y(t+\Delta t)-y(t)}{x(t+\Delta t)-x(t)} = \frac{y(t+\Delta t)-y(t)}{\Delta t} \cdot \frac{\Delta t}{x(t+\Delta t)-x(t)} \]
令$\Delta t \to 0$便得
\[ \frac{\dif y}{\dif x} = \frac{y'(t)}{x'(t)} \]
当然这里需要$x'(t) \neq 0$，这就是参变量函数的导数公式.

\begin{example}
  对于圆来说，它的参数方程是
  \[
    \begin{cases}
      x=\cos{\theta} \\
      y = \sin{\theta}
    \end{cases}
  \]
  于是它在$\theta=\theta_0$处的导数是
  \[ \frac{\dif y}{\dif x} = -\cot{\theta_0} \]
\end{example}

对于函数$y=f(x)$来说，它也可以看成是由以下的参数方程决定的曲线
\[
  \begin{cases}
    x = t \\
    y = f(t)
  \end{cases}
\]

\subsection{高阶导数}
\label{sec:high-level-derivative}

如果一个函数连续，则它的图象是一条不连续不间段的曲线，而如果它又可导，则它的曲线呈现出光滑无转折点的特征，那么由于导函数的存在，自然会问到导函数是否也可导这样一个问题，也就是导数的导数，即高阶导数。

\begin{definition}
  如果函数$f(x)$在某个区间上存在导函数，且导函数也可导，则称导函数的导函数是$f(x)$的\emph{二阶导数}，记作$f''(x)$或者$\frac{\dif^2y}{\dif x^2}$，类似的可以得到\emph{三阶导数}$\frac{\dif^3y}{\dif x^3}$或者$y^{(3)}$或者$f^{(3)}(x)$、\emph{四阶导数}$\frac{\dif^4 y}{\dif x^4}$或者$f^{(4)}(x)$...$n$阶导数$\frac{\dif^n y}{\dif x^n}$或者$f^{(n)}(x)$，这些统称\emph{高阶导数}.
\end{definition}

下面考虑基本函数的高阶导数。

1. 幂函数$y=x^p(x>0, p \in \mathbb{R})$.

显然有
\begin{align*}
  \frac{\dif y}{\dif x} & = px^{p-1} \\
  \frac{\dif^2 t}{\dif x^2} & = p(p-1)x^{p-2} \\
  \cdots \\
  \frac{\dif ^n y}{\dif x^n} & = p(p-1)\cdots (p-n+1)x^{p-n}
\end{align*}

对于指数是正整数$m$的情形来说，函数$x^m(m \in \mathbb{N}_+)$的一阶导数是$m-1$次多项式，二阶导数是$m-2$阶多项式，$m$阶导数则成为常数，阶数更高阶的导数将恒为零函数。

2. 指数函数$y=a^x(a>0,a \neq 1)$.

这时有
\begin{align*}
  \frac{\dif y}{\dif x} & = a^x \ln{a} \\
  \frac{\dif^2 y}{\dif x^2} & = a^x (\ln{a})^2 \\
  \frac{\dif^3 y}{\dif x^3} & = a^x (\ln{a})^3 \\
  \cdots \\
  \frac{\dif^n y}{\dif x^n} & = a^x (\ln{a})^n \\
\end{align*}

对于$y=\mathrm{e}^x$来说，则因为$\frac{\dif y}{\dif x} = \mathrm{e}^x = y$，所以它的任意阶的导函数仍然是它自己。

3. 对数函数$y=\log_a x(a>0, a \neq 1)$.

因为求一阶导数后就成为幂函数，所以可以应用幂函数的高阶导数结果.
\begin{align*}
  \frac{\dif y}{\dif x} & = \frac{1}{x \ln{a}} \\
  \frac{\dif ^2y}{\dif x^2} & = - \frac{1}{x^2\ln{a}} \\
  \cdots \\
  \frac{\dif^ny}{\dif x^n} & = \frac{(-1)^{n-1}(n-1)!}{x^n \ln{a}}
\end{align*}

特别情况是
\[ \frac{\dif^n (\ln{x})}{\dif x^n} = \frac{(-1)^{n-1}(n-1)!}{x^n} \]

4. 三角函数

正弦函数$y=\sin{x}(x \in \mathbb{R})$
\begin{align*}
  \frac{\dif y}{\dif x} & = \cos{x} = \sin{\left( x+\frac{\pi}{2} \right)} \\
  \frac{\dif^2 y}{\dif x^2} & = -\sin{x} = \sin{(x+\pi)} \\
  \cdots \\
  \frac{\dif^ny}{\dif x^n} & = \sin{\left( x+\frac{n\pi}{2} \right)}
\end{align*}

同理，对于余弦也有
\[ \frac{\dif^n (\cos{x})}{\dif x^n} = \cos{\left( x+\frac{n\pi}{2} \right)} \]

对于正切函数$y=\tan{x}$，先求出低数较高的几个导数如下
\begin{align*}
  \frac{\dif y}{\dif x} & = 1+\tan^2{x} \\
  \frac{\dif^2 y}{\dif x^2} & = 2\tan{x}(1+\tan^2{x}) \\
  \frac{\dif^3y}{\dif x^3} & = (2+6\tan^2{x})(1+\tan^2{x})
\end{align*}
由复合函数求导法则可知，其$n$阶导数中必然包含因式$1+\tan^2{x}$，而剩下的部分是一个关于$\tan{x}$的$n-1$次多项式，即
\[ \frac{\dif^n (\tan{x})}{\dif x^n} = (1+\tan^2{x})g_n(\tan{x}) \]
求导便得
\[ \frac{\dif^{n+1}y}{\dif x^{n+1}} = (1+\tan^2{x})[2\tan{x}g_n(\tan{x})+(1+\tan^2{x})g_n'(\tan{x})] \]
即$g_n(t)$具有如下的递推公式
\[ g_{n+1}(t) = 2tg_n(t)+(1+t^2)g_n'(t) \]
且$g_1(t)=1$.

5. 对于反三角函数.

\subsection{莱布尼茨公式}
\label{sec:Leibniz-formular-for-high-level-derivative-of-multiply}

设两个函数$f(x)$与$g(x)$都存在高阶导数，来讨论一下它俩之积的高阶导数，设$h(x)=f(x)g(x)$，根据乘积函数的求导法则，可以求得
\begin{align*}
  h'(x) & = f'(x)g(x)+f(x)g'(x) \\
  h''(x) & = f''(x)g(x)+2f'(x)g'(x)+f(x)g''(x) \\
  h''''(x) & = f'''(x)g(x)+3f''(x)g'(x)+3f'(x)g''(x)+f(x)g'''(x)
\end{align*}
易见这与二项式定理非常相似，利用数学归纳法可以证明下面一般性的结果:

\begin{theorem}
  设函数$f(x)$与$g(x)$都在某个共同的区间上存在直到$n$阶的导函数，则乘积$h(x)=f(x)g(x)$的$n$阶导数是
  \[ h^{(n)}(x) = \sum_{i=0}^n C_n^i f^{(n-i)}(x)g^{(i)}(x) \]
\end{theorem}

\subsection{微分与高阶微分}
\label{sec:difference-and-high-level-difference}

现在来讨论一个重要的概念：微分。

假定函数$f(x)$在$x_0$的某邻域内有定义且在$x_0$处可导，那么有
\[ \Delta y = f'(x_0)\Delta x + o(\Delta x) \]
即函数值的增量$\Delta y$可以写成一个自变量增量的倍数$f'(x_0)\Delta x$与一个自变量增量的高阶无穷小之和，也就是说，函数值的增量$\Delta y$作为一个无穷小，我们从中分离出了主要成分$f'(x_0)\Delta x$，而剩下的部分与主要成分相比可以忽略不计（高阶无穷小），这个主要成分正好是自变量增量的倍数，称为\emph{线性主部}，于是提出微分的概念如下:
\begin{definition}
  设函数$f(x)$在$x_0$的某个邻域内有定义，如果存在常数$A$，使得当自变量增量$\Delta x$趋于零时，函数值增量$\Delta y$与$A\Delta x$相差一个$\Delta x$的高阶无穷小，即
  \[ \Delta y = A \Delta x + o(\Delta x) \]
  则称函数$f(x)$在$x_0$处\emph{可微}，而表达式$A\Delta x$就称为函数$f(x)$在$x_0$处的\emph{微分}，记作$\dif y |_{x=x_0}$或者$\dif f(x_0)$.
\end{definition}

微分概念的核心就是从无穷小中分离出最主要的线性成分，这部分就是函数的微分。

如果函数$f(x)$在$x_0$处可导，显然就有
\[ \Delta y = f'(x_0)\Delta x + o(\Delta x) \]
这表明，$f'(x_0)\Delta x$就是函数在该处的微分，也就是$A=f'(x_0)$，微分定义中显然$A$若存在也不可能有多个值，所以得到结论：函数在某点处可微的充分必要条件是在该点处可导。而微分就是导数与自变量的增量之积。

对于自变量而言，如果把它看成它自己的函数，显然有$\dif x = \Delta x$，所以微分表达式通常写成
\[ \dif y = f'(x_0) \dif x \]
而不是写成$\dif y = f'(x_0) \Delta x$，把上式改写成
\[ f'(x_0) = \frac{\dif y}{\dif x} \]
这就表明，函数在某点处的导数值，正是该点处函数的微分与自变量比的微分之比，这就是导数被称为微商以及导数符号$\frac{\dif y}{\dif x}$的由来。

微分可以用于一些近似计算.

\begin{example}
  ，例如，要计算$\sqrt{4.01}$，由开方函数的微分$\dif (\sqrt{x})=\frac{\dif x}{2 \sqrt{x}}$得
  \[ \sqrt{4.01} \approx \sqrt{4} + \frac{0.01}{2 \sqrt{4}} = 2.0025 \]
  这与精确值$\sqrt{4.01}=2.0024984\ldots$接近的很好。
\end{example}

有了导数与微分的关系，根据基本函数的导法公式，可以得出对应的微分公式

1. $y=c$, $\dif y = 0$.

2. $y=x^p(p \in \mathbb{R},x>0)$, $\dif y = px^{p-1} \dif x$.

3. $y=a^x(a>0,a \neq 1)$,$\dif y=a^x\ln{a} \dif x$,特殊情况:$\dif (\mathrm{e}^x) = \mathrm{e}^x \dif x$.

4. $y=\log_a x(a>0,a\neq 1,x>0)$,$\dif y=\frac{\dif x}{x \ln{a}}$，特殊情况:$\dif (\ln{x}) = \frac{\dif x}{x}$.

5. 三角函数
\[ \dif (\sin{x}) = \cos{x} \dif x, \  \dif (\cos{x}) = -\sin{x} \dif x, \  \dif (\tan{x}) = \sec^2{x} \dif x \]

6. 反三角函数
\[ \dif (\arcsin{x}) = \frac{\dif x}{\sqrt{1-x^2}}, \  \dif (\arccos{x}) = - \frac{\dif x}{\sqrt{1-x^2}}, \ \dif (\arctan{x}) = \frac{\dif x}{1+x^2} \]

以及微分法则
\begin{enumerate}
\item $\dif (cf(x)) = c \dif (f(x))$，这里$C$是常数.
\item $\dif (f(x) \pm g(x)) = \dif (f(x)) \pm \dif (g(x))$.
\item $\dif (f(x)g(x)) = \dif (f(x))g(x) + f(x) \dif (g(x))$.
\item $\dif \left( \frac{f(x)}{g(x)} \right) = \frac{\dif (f(x))g(x) - f(x) \dif (g(x))}{f^2(x)}$.
\end{enumerate}

由反函数的求导法则，我们可以建立反函数的微分法则，设$y=f(x)$的反函数为$x=\varphi(y)$，那么有
\[ \dif y = f'(x) \dif x, \  \dif x = \varphi'(y) \dif y \]
而$f'(x)\varphi'(y)=1$，所以
\[ \dif x = \frac{\dif y}{f'(x)} \]

导数有高阶导数，微分也可以建立高阶微分的概念，对函数$f(x)$来说，它的微分
\[ \dif y = f'(x) \dif x \]
既是$x$的函数，同时也是自变量增量$\dif x$的函数，现在把$x$看成主元，即保持$\dif x$为常量，再次进行微分，得
\[ \dif^2 y = \dif (f'(x) \dif x) = \dif (f'(x)) \dif x = f''(x) \dif x^2 \]
这里$\dif x^2 = (\dif x)^2$是一个特别记号，以与函数$y=x$的二阶微分符号$\dif^2 x$相区别。上式就是函数$f(x)$的\emph{二阶微分}，同样，还可以求三阶微分
\[ \dif^3 y = \dif (\dif^2 f(x)) = \dif (f''(x) \dif x^2) = f^{(3)}(x) \dif x^3 \]
容易得知，对任意正整数$n$，有
\[ \dif^n y = f^{(n)}(x) \dif x^n \]
这就是$n$阶微分，而这符号也正是高阶导数符号的来源。

\subsection{微分的形式不变性}
\label{sec:the-non-variabriant-format-of-differtial}

前面已经讲过，设复合函数$h(x)=f(g(x))$是由$y=f(u)$及$u=g(x)$复合而成，那么有求导公式
\[ h'(x) = f'(g(x))g'(x) \]
因此它的微分为
\[ \dif (h(x)) = f'(g(x)) g'(x) \dif x \]
但是我们知道，上式右端中的因子$g'(x) \dif x$正是函数$g(x)$的微分，即
\[ \dif (g(x)) = g'(x) \dif x \]
因此前一式子可以写成
\[ \dif (f(g(x))) = f'(g(x)) \dif (g(x)) \]
这与函数$f(x)$的微分表达式$\dif (f(u)) = f'(u) \dif u$一模一样，只是在其中把$u$用$u=g(x)$替换掉了而已，这表明一个事实，在微分表达式中，如果一个变量又是别的变量的函数，可以在替换变量的同时把该变量的微分替换为相应函数的微分就行，微分表达式仍然成立，这就是\emph{微分的形式不变性}.

复合函数的导数规则看起来不如微分的形式不变性来得简单。

但是对于高阶微分，这个性质就不再了，以二阶微分为例，函数$y=f(u)$的二阶微分是
\[ \dif^2 y = f''(u) \dif u^2 \]
但假若$u=g(x)$，那么现在的二阶微分是
\[ \dif^2 y = \dif (\dif (f(g(x)))) = \dif (f'(g(x))g'(x)\dif x) = (f''(g(x))g'(x)+f'(g(x))g''(x)) \dif x^2 \]
但若直接在$y=f(u)$的二阶微分中以$u=g(x)$替换，则得出
\[ f''(g(x)) (\dif g(x))^2 = f''(g(x)) g'^2(x) \dif x^2 \]
可知两者并不相等，因此，高阶微分不再具有形式不变性。

\subsection{微分用于近似计算}
\label{sec:approx-by-differtial}

微分提供了一个近似计算的思路，设函数$y=f(x)$在$x=x_0$处可微，则在$x_0$处给自变量一个微小的增量$\Delta x$，函数值也相应有一个增量$\Delta y$，有
\[ \Delta y = f(x_0+\Delta x) - f(x_0) = f'(x_0) \Delta x + o(\Delta x) \]
于是
\[ f(x_0+\Delta x) = f(x_0) + f'(x_0) \Delta x + o(\Delta x) \]
于是有如下的近似公式
\[ f(x_0+\Delta x) \approx f(x_0) + f'(x_0) \Delta x \]
这就是说，可以用曲线在某点处的切线来逼近它，并且由于误差是$\Delta x$的高阶无穷小，所以相对误差可以任意小，只要$\Delta x$足够小。

\begin{example}
  可以建立如下的近似公式，当$|x|$非常小时，有
  \begin{align*}
    (1+x)^{\alpha} & \approx 1 + \alpha x \\
    \mathrm{e}^x & \approx 1 + x \\
    \ln{(1+x)} & \approx x \\
    \sin{x} & \approx x \\
    \tan{x} & \approx x
  \end{align*}
  其中第一个式子中，取$\alpha=\frac{1}{2}$，可得
    \[ \sqrt{1+x} \approx 1 + \frac{1}{2}x \]
\end{example}

\subsection{微分方程}
\label{sec:differtial-equation}

我们知道指数函数$y=f(x)=\mathrm{e}^x$的导函数就是它自己，用微分的形式写出来就是
\[ \frac{\dif f(x)}{\dif x} = f(x) \]
或者简单写成
\[ \frac{\dif y}{\dif x} = y \]
或者更加简洁的写成
\[ y'=y \]
像这样把函数自身与其微分(或者导数)联系起来的方程，就称为\emph{微分方程}。

上面的例子就表明指数函数$y=\mathrm{e}^x$就满足微分方程
\[ \frac{\dif y}{\dif x} = y \]
我们还可以写出一些微分方程
\begin{align*}
  y''+y'+y&=0 \\
  y'^2+x^2&=0 \\
  y''+2y'y+y^2& = 0
\end{align*}

如果一个函数与它的导函数满足一个给定的微分方程，就称这函数是这微分方程的一个\emph{解}.例如，函数$y=\mathrm{e}^x$就是微分方程$y'=y$的一个解，但并不是唯一解，因为零函数也满足这方程。

\begin{example}
  通过求导可以验证，函数
  \[ y=C_1 \cos{x} + C_2 \sin{x} \]
  满足微分方程
  \[ y''+y=0 \]
  这里$C_1$和$C_2$是常数。
\end{example}

\begin{example}
  函数
  \[ y= C_1 \cosh{x} + C_2 \sinh{x} \]
  满足微分方程
  \[ y''-y=0 \]
\end{example}

\begin{example}
  可以验证，函数
  \[ y = C_1 \mathrm{e}^{\lambda_1 x} + C_2 \mathrm{e}^{\lambda_2 x} \]
  满足微分方程
  \[ y''-(\lambda_1+\lambda_2)y' + \lambda_1 \lambda_2 y = 0 \]
  像这样由$y$、$y'$、$y''$等各阶导数的线性组合(系数可以是常数或者自变量$x$的表达式)而成的微分方程，称为\emph{线性微分方程}，如果各项的系数又是常数，则称为\emph{常系数线性微分方程}。
\end{example}

\begin{example}
  在这个例子中，我们来解下面这个微分方程
  \[ y'-\lambda y = 0 \]
  作函数$u=y\mathrm{e}^{-\lambda x}$，那么有
  \[ u'=\mathrm{e}^{-\lambda x} (y'-\lambda y) = 0 \]
  根据前面的结果，函数$u$只能是常数函数，即
  \[ y\mathrm{e}^{-\lambda x} = C \]
  从而
  \[ y = C \mathrm{e}^{\lambda x} \]
  这样就解出了这个微分方程.
\end{example}




%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../calculus-note"
%%% End:
