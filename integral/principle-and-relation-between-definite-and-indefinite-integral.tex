
\section{定积分与不定积分的原理及两者之间的关系}
\label{sec:principle-and-relation-between-definite-and-indefinite-integral}

在初等范围内，我们经常见到一个量对另一个量的累积(乘积)，例如物体的面积是纵横两个方向上的累积，路程是速度对时间的累积，功是力对位移的累积，等等。但是以前我们通常只会处理最简单的情况，我们只会求规则图形的面积，不会计算不规则图形的面积，只会处理匀速运动的路，不会计算任意变速运动的路程，只会计算恒定力做功，不会计算变力做功，定积分就是为了处理这类问题而被发现的。

后来牛顿与莱布尼茨又发现了定积分与函数的原函数之间存在着直接又简单的联系，与是积分学与微积分学之间的深刻关系也被揭示在世人面前，其影响之大，使得这个结论直接被冠之以微积分学基本定理，成为微积分学的基石。

\subsection{黎曼和与定积分的概念}
\label{sec:riemann-sum-and-concept-of-definite-integral}

我们先来看几个例子。

\begin{example}[曲边梯形的面积]
\begin{figure}
  \centering
  \includegraphics[scale=0.7]{integral/pic/area-of-curvilinear-trapezoid.pdf}
  \caption{曲边梯形的面积}
  \label{fig:area-of-curvilinear-trapezoid}
\end{figure}

如 \autoref{fig:area-of-curvilinear-trapezoid} 所示，定义在区间 $[a,b]$ 上的正值函数 $y=f(x)$的图象与直线$x=a$、$x=b$以及 $x$ 轴围成了一个曲边梯形，我们考虑它的面积，也就是函数图象下方的面积。

通过在区间$[a,b]$内插入一些点把区间 $[a,b]$ 划分成 $n$ 个小区间(不必是等分):
\[ a=x_0<x_1< \cdots < x_{i-1} < x_i < \cdots < x_n = b \]
这样曲边梯形就被划分成了$n$个小的曲边梯形，设曲边梯形面积是 $S$，第 $i$ 个区间上的曲边梯形面积是 $S_i$，那么
\[ S = \sum_{i=1}^n S_i \]
因为每个小区间上的曲边梯形比较小，所以我们用矩形的面积来近似其面积，在每个小区间上任意各取定一个点:$\xi_i\in [x_{i-1}, x_i](i=1,2,\ldots,n)$，用 $y_i=f(\xi_i)$来作矩形的上边界，得到一个小矩形，其面积是 $f(\xi_i) \Delta x_i$，这里 $\Delta x_i = x_i-x_{i-1}$ 是第 $i$ 个小区间的长度，于是
\[ S_i \approx f(\xi_i) \Delta x_i \]
那么曲边梯形的总面积，就可以用这$n$个小矩形的面积之和来近似代替:
\[ S = \sum_{i=1}^n S_i \approx \sum_{i=1}^n f(\xi_i) \Delta x_i \]
显然，小区间越多，各个小区间长度越小，这个误差就越小，考虑划分的极限情况，即各小区间的最大长度趋于零时，上式右端将以左边为极限。
\end{example}

\begin{example}[变速直线运动的位移]
  假定某质点做变速直线运动，其速度是时间的函数$v=v(t)$，现在我们要计算它从$t=a$到$t=b$这段时间段内发生的位移. 如果速度恒定不变，那么只要将速度与时间段长度相乘即可得出结果，但是现在速度是个时时刻刻都在改变的量，这个办法行不通了，但是我们可以将该时间段划分成很多很小的时间内，在每一个很小的时间内，速度的改变量很小，因此可以近似的看成是匀速运动，从而质点在这很小的时间内所发生的位移是可以近似求出的，于是总的位移也就可以近似求出。

  在时间段$t\in[a,b]$内插入$n-1$个时间点将其划分为$n$个小的时间区间(不必等分):
  \[ a = t_0 < \cdots < t_{i-1} < t_i < \cdots < t_n = b \]
  在每个小区间段内随机取一个点$t=\xi_i$，那么质点在该小的时间段内可以视为以大小为$v(\xi_i)$的速度匀速运动，于是在这个小区间上发生的位移$S_i$便有近似
  \[ S_i \approx v(\xi_i) \Delta t_i \]
  这里$\Delta t_i = t_i-t_{i-1}$是该小时间段的长度.于是质点在区间$[a,b]$内所发生的总位移有如近似:
  \[ S = \sum_{i=1}^n S_i \approx \sum_{i=1}^n v(\xi_i) \Delta t_i \]
  如果时间段划分得越小，那么上式的误差就越小，在各小时间段的最大长度趋于零时，误差即趋于零。
\end{example}

\begin{example}[变力做功]
  考虑一个变化的力$F$推动某物体移动了一段直线路程$L$，我们把这一段直线路程对应为区间$[a,b]$，这里$L=b-a$，而变力$F$在该路程每个位置处的大小是$F=F(l), l\in[a,b]$，同样的，我们把这段路程划分成很多小区间:
  \[ a = l_0 < \cdots l_{i-1} < l_i < \cdots < b = l_n \]
  在每个小区间上可以近似是恒力做功(只要区间划分得很小，那么在小区间上力的改变量也可以很小)，在每个小区间上任意取一点$\xi \in [x_{i-1},x_i]$，在这一段小区间上可以视为以恒力$F_i=F(\xi_i)$进行的恒力做功，因此这一段小区间上做的功有近似:
  \[ W_i \approx F(\xi_{i}) \Delta l_i \]
  其中$\Delta l_i = l_i-l_{i-1}$是小区间长度.变力$F$在区间$[a,b]$内总共所做的功
  \[ W = \sum_{i=1}^n W_i \approx \sum_{i=1}^n F(\xi_i) \Delta l_i \]
\end{example}

总结上面三个例子，有很多情况下我们需要求出一个量$A$对另一个量$B$的累积$P$(即乘积)，如果量$A$不依赖于量$B$的变化而变化，那么我们可以很容易的得出这个乘积:
\[ P = A \cdot \Delta B = A (B'-B_0) \]
但是通常量$A$它不是恒定不变的，而是依赖于量$B$的，或者说，它是量$B$的函数$A=A(B)$，这时为了求出这个累积量，可以通过将量$B$的变化区间$[B_0,B']$划分成许多小区间，然后在每个小区间上将量$A$视为恒定不变的，从而该小区间上的累积量$P_i$可以近似得出，于是在整个区间上的累积量$P$也就可以用它们之和来近似代替，只要把区间划分得足够细，就可以使得误差足够小，在小区间的最大长度趋于零的极限情况，就得出了累积量的精确值了，从这个意义上说，定积分其实就是一种广义的乘法运算。

这里需要说明的一点是，这个近似的误差，是在小区间的最大长度趋于零的情况下才会足够小，而不是小区间数目趋于无穷的情况下，因为即便小区间数目再多，也不能保证有个别区间长度比较大，从而该小区间上的误差无法解决，例如用$x_i = \frac{1}{i}$来划分区间$[0,1]$，这一点务必注意。

现在，是时候给出定积分的定义了:
\begin{definition}[积分和与定积分]
  设函数$f(x)$在闭区间$[a,b]$上有定义，在该闭区间上插入一系列分点:
  \[ a = x_0 < \cdots < x_{i-1} < x_i < \cdots < x_n = b \]
  将之划分为$n$个小区间，并在每一个小区间$[x_{i-1},x_i]$上任意取一个点$\xi_i\in [x_{i-1},x_i]$，作和式(称为\emph{积分和}或\emph{黎曼和})
  \[ \sum_{i=1}^n f(x_i) \Delta x_i \]
  这里$\Delta x_i = x_i-x_{i-1}$是第$i$个小区间的长度。如果存在一个数$P$，它满足:对于任意小的正实数$\varepsilon >0$，都存在另一个正实数$\delta >0$，使得所有划分中，只要它的最大小区间的长度小于$\delta$，那么无论怎么选取各个小区间上的$\xi_i$的值，都有:
  \[ \left| \sum_{i=1}^n f(\xi_i) \Delta x_i - P \right| < \varepsilon \]
  那么就称函数$f(x)$在闭区间$[a,b]$上是\emph{可积的}，而数$P$，就称为是函数$f(x)$在闭区间$[a,b]$上的\emph{定积分}值，用下面符号表示:
  \[ P = \int_a^b f(x)dx \]
  其中的$a$、$b$称为\emph{积分上限}和\emph{积分下限}.
\end{definition}

关于这个定义，作几点说明.

定义的后半部分其实就是极限的 $\varepsilon - \delta$ 语言，为什么不直接使用极限符号呢，因为这里有一个问题是，极限符号只能体现出小区间的最大长度趋于零，但却体现不出各小区间上的点$\xi_i$取法的任意性。

定积分的这个符号，其实它就是黎曼和的极限形式，黎曼和的$\Sigma$直接变成了被拉长的字母S(sum代表求和)，黎曼和上下标变成了区间的上下限，而黎曼和中的区间长度$\Delta x_i$变成了自变量$x$的微分，可以理解为无限小的区间长度，这么一看，定积分符号就是黎曼和的极限形式就容易理解了。

所谓定积分，就是指定了积分上限和积分下限的积分，后面我们还见到不定积分，即没有指定上下限的积分，积分这个概念，指的就是函数$f(x)$对自变量$x$的累积。

前面举了曲边梯形面积的例子，需要注意的是，如果函数$f(x)$在闭区间上不能保证恒为正值，那么它在区间上的定积分(如果存在的话)等于位于$x$轴上方的面积减去$x$轴下方的面积，即代数面积。

\subsection{可积条件}
\label{sec:integrable-function}

现在我们研究函数在闭区间上可积的条件。

先提出\emph{达布和}的概念:
\begin{definition}
  设函数$f(x)$在闭区间$[a,b]$上有定义，对于该闭区间的某个划分:
  \[ a=x_0 < \cdots < x_{i-1} < x_i < \cdots < x_n = b \]
  设$f(x)$在每个小区间$[x_{i-1},x_i]$上的上确界为$M_i$，下确界为$m_i$，作和式:
  \[ s = \sum_{i=1}^n m_i \Delta x_i \]
  称为\emph{下积分和}，再作和式
  \[ S = \sum_{i=1}^n M_i \Delta x_i \]
  称为\emph{上积分和}，上积分和与下积分和都称为\emph{达布和}.
\end{definition}

由积分布和的概念，在每个小区间$[x_{i-1},x_i]$上任意取定点$\xi_i$，有
\[ m_i \leqslant f(\xi_i) \leqslant M_i \]
因此有
\[ \sum_{i=1}^n m_i \Delta x_i \leqslant \sum_{i=1}^n f(\xi_i) \Delta x_i \leqslant \sum_{i=1}^n M_i \Delta x_i \]
即是说，对于同一个划分而言，积分和介于上积分和与下积分和之间，而上下积分和分别是积分和的上确界和下确界。

达布和具有两个性质:

\begin{property}
  如果在分划中增加一些新的分点，那么上积分和不会增加，下积分和不会减小。
\end{property}

\begin{proof}
  假如第$i$个区间$[x_{i-1},x_i]$中新插入一个分点$x'$，设函数$f(x)$在区间$[x_{i-1},x']$上的上下确界分别是$M_{i1}$和$m_{i1}$，而在区间$[x',x_i]$上的上下确界分别是$M_{i2}$和$m_{i2}$，那么必定有
  \[ m_i \leqslant m_{i1}, m_i \leqslant m_{i2} \]
  以及
  \[ M_i \geqslant M_{i1}, M_i \geqslant M_{i2} \]
  而下积分和原来对应区间$[x_{i-1},x_i]$上的那一项
  \[ m_i (x_i-x_{i-1}) \]
  将由下面的两项代替:
  \[ m_{i1}(x'-x_{i-1})+m_{i2}(x_i-x') \]
  显然它的值不会减小，只会增加或者保持不变. 同样上积分和中原来的那一项
  \[ M_i(x_i-x_{i-1}) \]
  将被下面两项代替:
  \[ M_{i1}(x'-x_{i-1}) + M_{i2}(x_i-x') \]
  同样，它的值不会增加，只会减小或者保持不变。
  这是只添加一个分点的情况，而多个分点可以逐个添加，每添加一个分点，上积分和都保持不增加，下积分和不减小，所以结论得证。
\end{proof}

\begin{property}
上积分和永远不小于下积分和，无论是对于同一个划分还是不同的划分均是如此.
\end{property}

\begin{proof}
  对于同一个划分来说，上积分和不小于下积分和是显然的，所以需要证明的是两个不同的划分$A$和$B$，$A$的上积分和不会小于$B$的下积分和。

  我们可以将两个划分的分点合并在一起组成一个新的更细的划分$C$，它是在$A$的分点中加入了一些新的分点($B$的分点)，因此按刚证明过的上一个性质，知$C$划分的上积分和不会大于$A$的上积分，同样，$C$也是在$B$的分点中加入了一些新的分点($A$的分点)，所以$C$划分的下积分和不会小于$B$划分的下积分和，于是我们有
  \[ S_C \leqslant S_A, s_C \geqslant s_B \]
  而又由于
  \[ s_C \leqslant S_C \]
  因此
  \[ s_B \leqslant S_A \]
  即得证.
\end{proof}

达布和与黎曼和相比，它不需要在每个小区间上取一个点，从而对它的讨论将与这个点的选择无关。回忆定积分的定义中，我们本应该直接使用极限语言，直接说当各小区间的最大长度趋于零时，黎曼和的极限便是定积分，但是无奈还有各个小区间上的点怎么选择的干扰，所以不得不使用了$\varepsilon-\delta$语言来描述，并要求是无论怎么选择那些点，都不影响误差限的成立，而现在达布和没有这个问题，我们可以直接使用极限语言了。

利用达布和，我们有如下的可积条件:
\begin{theorem}
  函数$f(x)$在闭区间上可积的充分必要条件是:
  \[ \lim_{\lambda \to 0} (S - s) = 0 \]
  这里 $\lambda$ 表示划分下的各小区间的最大长度.
\end{theorem}

\begin{proof}
  先证必要性，假定已经有函数$f(x)$在闭区间$[a,b]$上可积，且定积分值为$P$，那么就是说，对于任意小的正实数$\varepsilon > 0$，存在另一个充分小的正实数$\delta > 0$，使得只要划分的小区间最大长度小于$\delta$，则无论怎么选定各个小区间上的$\xi_i$，都有
  \[ \left| \sum_{i=1}^n f(\xi_i) \Delta x_i \right| < \varepsilon \]
  那么作为黎曼和上下确界的达布和，自然也有
  \[ |s-P| \leqslant \varepsilon, |S-P| \leqslant \varepsilon \]
  于是
  \[ |S-s| = |(S-p) - (s-p)| \leqslant |S-p| + |s-p| \leqslant 2\varepsilon \]
  这就是说，$|S-s|$也是可以任意小的，因此必要性成立.

  再来证明充分性，如果已经有上下积分和之差在小区间最大长度趋于零时也趋于零，那么由于任意一个上积分和不小于任意一个下积分和，也就是上积分的集合有下界，而下积分的集合有上界，于是各有确界，并且上积分和的下确界必定等于下积分和的上确界(否则两者之差不可能趋于零)，设此共同的确界是$I$，那么我们来证明，这个$I$便是函数在这闭区间上的定积分。

  对于任意小的正实数$\varepsilon > 0$，存在另一个充分小的正实数$\delta > 0$，使得只要划分的最大小区间长度小于$\delta$，就有$|S-s|<\varepsilon$，但是又由于
  \[ s \leqslant I \leqslant S \]
  因此对于这个$s$和$S$有
  \[ I - \varepsilon \leqslant s \leqslant I \]
  以及
  \[ I \leqslant  S \leqslant I+\varepsilon \]
  而在此区间上的黎曼和$\sigma$满足(无论怎么选择$\xi_i$)
  \[ s \leqslant \sigma \leqslant S \]
  所以
  \[ I - \varepsilon \leqslant \sigma \leqslant I+\varepsilon \]
  这便表示函数$f(x)$在闭区间$[a,b]$上可积，并且积分值为$I$.
\end{proof}

在某个划分中，对于每一个小区间$[x_{i-1},x_i]$而言，$M_i-m_i$可以视作函数$f(x)$在该小区间上的振幅，记作$\omega_i$，于是上述定理中的等式也可以写为
\[ \lim_{\lambda \to 0} \sum_{i=1}^n \omega_i \Delta x_i = 0 \]
在接下来我们将会用到这种形式.

\begin{inference}
  闭区间上的无界函数不可积.
\end{inference}
因为对于闭区间上的无界函数，无论把小区间划分得有多细，总存在一个振幅无穷大的小区间，按前述定理，这个定积分不存在。

前面已经说明了，上积分和虽然是与划分有关的，但是它有下界，任何一个下积分和都是它的下界，那么它的下确界，显然是与划分无关的，同样，下积分和也是有上确界的，于是我们类似于积分和与定积分的关系，定义上积分与下积分的概念:
\begin{definition}[上积分与下积分]
  上积分和的下确界称为\emph{上积分}，记作$I^{*}$，下积分和的上确界称为\emph{下积分}，记作$I_{*}$.
\end{definition}
显然，上积分与下积分只与被积函数和被积区间有关，与区间的划分无关，并且，只要函数在闭区间上是有界的，那么上积分与下积分就总是存在的。

虽然上积分与下积分是用确界定义的，但很自然的，它们也可以看作极限:
\begin{theorem}
  上积分是上积分和的极限，下积分是下积分和的极限，即:
  \[ I^{*} = \lim_{\lambda \to 0} S, I_{*} = \lim_{\lambda \to 0} s  \]
  这里 $\lambda$ 表划分中子区间的最大长度.
\end{theorem}

\begin{proof}
  只证明上积分的结论，只需要证明：对于任意的正实数$\varepsilon>0$，都存在一个非常小的正实数$\delta>0$，使得对于最大子区间长度小于$\delta$的任意划分，都能保证其上积分和$S$与上积分$I$相差不超过$\varepsilon$，即
  \[ S<I^{*}+ \varepsilon \]
  首先根据确界概念，对于任意的正实数$\varepsilon>0$，都存在一个划分(记作$A$)，能够使得其上积分和满足:
  \[ S_A<I^{*}+\frac{1}{2}\varepsilon \]
  虽然我们现在还未确定$\delta$是多少，但是我们考虑最大子区间长度小于$\delta$的任意一个划分$X$，如果将划分$A$的分点全部加进$X$的分点中去，得到一个新划分$Y$，那么由上积分和的性质有$S_Y<S_X$，因此有
  \[ S_Y<I^{*}+\frac{1}{2}\varepsilon \]
  接着我们考虑这个在$X$划分中加入若干分点到底对上积分和能造成多大的变化，也就是估计$S_X$与$S_Y$之差，因为这个划分$A$我们是针对$\varepsilon$取定的，我们假设它有$l$个分点，那么在划分$X$中插入$l$个分点，最多只能影响$X$中原来$l$个小区间上的积分和，且每个小区间上的积分和改变量不会超过$(M-m)\delta$，于是有
  \[ |S_Y-S_X|<l(M-m)\delta \]
  这里$M$和$m$分别是函数在整个要积分的闭区间上的上确界和下确界.因此如果取$\delta$使其满足
  \[ \delta < \frac{\varepsilon}{2l(M-m)} \]
  那么便有
  \[ |S_X-S_Y| < \frac{1}{2}\varepsilon \]
  从而
  \[ S_X < I^{*} + \varepsilon \]
\end{proof}


有了这个定理，那么我们现在可以利用上积分与下积分，把前面的可积条件写成下面的形式.
\begin{theorem}
  函数在闭区间上可积的充分必要条件是: 上积分与下积分相等，即
  \[ I^{*} = I_{*} \]
  并且在上下积分相等的情况下，这个共同值便是定积分的值.
\end{theorem}

这个定理的理论意义是如此之重要，因为前面已经说明首先闭区间上的无界函数是不可积的，而对于有界函数来说，它在闭区间上的上积分与下积分是一定存在的，所以定积分是否存在的问题，便归结于这个上积分与下积分是否相等的问题了。

\subsection{可积函数与不可积函数}
\label{sec:integrable-and-not-function}

虽然我们已经得出了函数在闭区间上可积的充分必要条件，但那个条件更多的是理论上的意义，对于一个给定的函数，要快速的判断可积性是比较困难的，所以这一节我们总结一些常用的可积函数和不可积函数。

\begin{theorem}
  闭区间上的连续函数总是可积的.
\end{theorem}

\begin{proof}
  由于闭区间上的连续函数必然是一致连续，即任给正实数$\varepsilon>0$，都存在另一个正实数$\delta>0$，使得对于该闭区间上任意两个自变量$x_1,x_2$，只要$|x_1-x_2|<\delta$，就能保证$|f(x_1)-f(x_2)|<\varepsilon$.也就是说，只要划分的最大子小区间长度小于$\delta$，那么所有子区间上的振幅都会小于$\varepsilon$，于是它对应的上下积分和之差
  \[ \sum_{i=1}^n \omega_i \Delta x_i < \varepsilon (b-a) \]
  这里$a$和$b$分别是闭区间的两个端点.上式便表明了函数的可积性。
\end{proof}

\begin{theorem}
  如果函数在闭区间上只有有限多个间断点，那么它是可积的.
\end{theorem}

\begin{theorem}
  如果函数在闭区间上单调有界，则它是可积的.
\end{theorem}


\subsection{定积分的性质}
\label{sec:properties-of-definite-integral}


\subsection{变动上限的积分函数}
\label{sec:variable-upper-limit-integral-function}

证明出：变动上限的连续函数的积分，其对于变动上限的导函数就是被积函数自己

\subsection{不定积分概念与性质,基本积分表}
\label{sec:indefinite-integral}

\subsection{牛顿-莱布尼茨公式}
\label{sec:newton-leibniz-formular}











%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../calculus-note"
%%% End:
